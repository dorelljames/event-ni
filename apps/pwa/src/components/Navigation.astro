---
const navigation = [
  { name: "Home", href: "/", icon: "home" },
  { name: "Explore", href: "/explore", icon: "search" },
  { name: "Saved", href: "/saved", icon: "bookmark" },
];

// Get the current pathname and ensure it's normalized
const currentPath = new URL(Astro.request.url).pathname;
const pathname = currentPath.endsWith("/") ? currentPath : `${currentPath}/`;
---

<nav
  class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 sm:hidden z-[500]"
>
  <div class="flex justify-around">
    {
      navigation.map((item) => {
        // Normalize the href path as well
        const itemPath = item.href.endsWith("/") ? item.href : `${item.href}/`;
        const isActive = pathname === itemPath;

        return (
          <a
            href={item.href}
            class:list={[
              "flex flex-col items-center px-3 py-3 text-xs font-medium transition-colors duration-200",
              isActive
                ? "text-purple-600"
                : "text-gray-600 hover:text-gray-900",
            ]}
            aria-current={isActive ? "page" : undefined}
          >
            {item.icon === "home" && (
              <svg
                class="w-6 h-6"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"
                />
              </svg>
            )}
            {item.icon === "search" && (
              <svg
                class="w-6 h-6"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                />
              </svg>
            )}
            {item.icon === "bookmark" && (
              <svg
                class="w-6 h-6"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"
                />
              </svg>
            )}
            <span class="mt-1.5 font-medium">{item.name}</span>
          </a>
        );
      })
    }
  </div>
</nav>
